<script setup>
import americanExpress from '@images/icons/payments/american-express.png'
import mastercard from '@images/icons/payments/mastercard.png'
import visa from '@images/icons/payments/visa.png'

const isUpgradePlanDialogVisible = ref(false)
const currentCardDetails = ref()
const isCardEditDialogVisible = ref(false)
const isCardAddDialogVisible = ref(false)
const isEditAddressDialogVisible = ref(false)

const openEditCardDialog = cardDetails => {
  currentCardDetails.value = cardDetails
  isCardEditDialogVisible.value = true
}

const creditCards = [
  {
    name: 'Tom McBride',
    number: '4851234567899865',
    expiry: '12/24',
    isPrimary: true,
    isExpired: false,
    type: 'mastercard',
    cvv: '123',
    image: mastercard,
  },
  {
    name: 'Mildred Wagner',
    number: '5531234567895678',
    expiry: '02/24',
    isPrimary: false,
    isExpired: false,
    type: 'visa',
    cvv: '456',
    image: visa,
  },
  {
    name: 'Lester Jennings',
    number: '5531234567890002',
    expiry: '08/20',
    isPrimary: false,
    isExpired: true,
    type: 'visa',
    cvv: '456',
    image: americanExpress,
  },
]

const currentAddress = {
  companyName: 'Pixinvent',
  billingEmail: 'gertrude@gmail.com',
  taxID: 'TAX-875623',
  vatNumber: 'SDF754K77',
  address: '100 Water Plant Avenue, Building 1303 Wake Island',
  contact: '+1(609) 933-44-22',
  country: '–†–æ—Å—Å–∏—è',
  state: 'Queensland',
  zipCode: 403114,
}

const currentBillingAddress = {
  firstName: 'Shamus',
  lastName: 'Tuttle',
  selectedCountry: '–†–æ—Å—Å–∏—è',
  addressLine1: '45 Rocker Terrace',
  addressLine2: 'Latheronwheel',
  landmark: 'KW5 8NW, London',
  contact: '+1 (609) 972-22-22',
  country: '–†–æ—Å—Å–∏—è',
  city: 'London',
  state: 'London',
  zipCode: 110001,
}
</script>

<template>
  <VRow>
    <!-- üëâ Current Plan -->
    <VCol cols="12">
      <VCard title="–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω">
        <VCardText>
          <VRow>
            <VCol
              cols="12"
              md="6"
              order-md="1"
              order="2"
            >
              <h6 class="text-h6 mb-1">
                –í–∞—à —Ç–µ–∫—É—â–∏–π –ø–ª–∞–Ω - –ë–∞–∑–æ–≤—ã–π
              </h6>
              <p>
                –ü—Ä–æ—Å—Ç–æ–π —Å—Ç–∞—Ä—Ç –¥–ª—è –≤—Å–µ—Ö
              </p>

              <h6 class="text-h6 mb-1">
                –ê–∫—Ç–∏–≤–µ–Ω –¥–æ 09 –¥–µ–∫ 2026
              </h6>
              <p>
                –ú—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏
              </p>

              <h6 class="text-h6 mb-1">
                <span class="d-inline-block me-2">‚ÇΩ99 –≤ –º–µ—Å—è—Ü</span>
                <VChip
                  color="primary"
                  size="small"
                  label
                >
                  –ü–æ–ø—É–ª—è—Ä–Ω—ã–π
                </VChip>
              </h6>
              <p class="mb-0">
                –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è –º–∞–ª–æ–≥–æ –∏ —Å—Ä–µ–¥–Ω–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞
              </p>
            </VCol>

            <VCol
              cols="12"
              md="6"
              order-md="2"
              order="1"
            >
              <!-- üëâ Alert -->
              <VAlert
                color="warning"
                variant="tonal"
              >
                <VAlertTitle class="mb-1">
                  –¢—Ä–µ–±—É–µ—Ç—Å—è –≤–∞—à–µ –≤–Ω–∏–º–∞–Ω–∏–µ!
                </VAlertTitle>
                <div class="text-base">
                  –í–∞—à –ø–ª–∞–Ω —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                </div>
              </VAlert>

              <!-- üëâ Progress -->
              <div class="d-flex justify-space-between font-weight-bold mt-4 mb-2">
                <h6 class="text-h6">
                  –î–Ω–∏
                </h6>
                <h6 class="text-h6">
                  26 –∏–∑ 30 –¥–Ω–µ–π
                </h6>
              </div>

              <VProgressLinear
                rounded
                color="primary"
                :height="10"
                :model-value="75"
              />
              <p class="text-sm mt-1">
                –í–∞—à –ø–ª–∞–Ω —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
              </p>
            </VCol>

            <VCol
              cols="12"
              order="3"
            >
              <div class="d-flex flex-wrap gap-4">
                <VBtn @click="isUpgradePlanDialogVisible = true">
                  –û–±–Ω–æ–≤–∏—Ç—å –ø–ª–∞–Ω
                </VBtn>

                <VBtn
                  color="error"
                  variant="tonal"
                >
                  –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
                </VBtn>
              </div>
            </VCol>
          </VRow>
        </VCardText>
      </VCard>
    </VCol>

      <!-- üëâ Payment Methods -->
    <VCol cols="12">
      <VCard title="–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã">
        <template #append>
          <VBtn
            prepend-icon="tabler-plus"
            size="small"
            @click="isCardAddDialogVisible = !isCardAddDialogVisible"
          >
            –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É
          </VBtn>
        </template>

        <VCardText class="d-flex flex-column gap-y-4">
          <VCard
            v-for="card in creditCards"
            :key="card.name"
            border
            flat
          >
            <VCardText class="d-flex flex-sm-row flex-column gap-6 justify-space-between">
              <div class="text-no-wrap">
                <img
                  :src="card.image"
                  :height="25"
                >
                <div class="my-2 d-flex gap-x-2 align-center">
                  <h6 class="text-h6">
                    {{ card.name }}
                  </h6>
                  <VChip
                    v-if="card.isPrimary || card.isExpired"
                    label
                    :color="card.isPrimary ? 'primary' : card.isExpired ? 'error' : 'secondary'"
                    size="small"
                  >
                    {{ card.isPrimary ? '–û—Å–Ω–æ–≤–Ω–∞—è' : card.isExpired ? '–ò—Å—Ç–µ–∫–ª–∞' : '' }}
                  </VChip>
                </div>
                <div class="text-body-1">
                  **** **** **** {{ card.number.substring(card.number.length - 4) }}
                </div>
              </div>

              <div class="d-flex flex-column text-sm-end gap-y-4">
                <div class="order-sm-0 order-1">
                  <VBtn
                    variant="tonal"
                    size="small"
                    class="me-4"
                    @click="openEditCardDialog(card)"
                  >
                    –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                  </VBtn>
                  <VBtn
                    color="error"
                    variant="tonal"
                    size="small"
                  >
                    –£–¥–∞–ª–∏—Ç—å
                  </VBtn>
                </div>

                <div class="order-sm-1 order-0 text-sm">
                  –ö–∞—Ä—Ç–∞ –∏—Å—Ç–µ–∫–∞–µ—Ç {{ card.expiry }}
                </div>
              </div>
            </VCardText>
          </VCard>
        </VCardText>
      </VCard>
    </VCol>

    <VCol cols="12">
      <!-- üëâ Billing Address -->
      <VCard title="–ê–¥—Ä–µ—Å –¥–ª—è –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–æ–≤">
        <template #append>
          <VBtn
            size="small"
            prepend-icon="tabler-plus"
            @click="isEditAddressDialogVisible = !isEditAddressDialogVisible"
          >
            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å
          </VBtn>
        </template>

        <VCardText>
          <VRow>
            <VCol
              cols="12"
              lg="6"
            >
              <VTable class="billing-address-table">
                <tr>
                  <td>
                    <h6 class="text-h6 text-no-wrap mb-2">
                      –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏:
                    </h6>
                  </td>
                  <td>
                    <p class="text-body-1 mb-2">
                      {{ currentAddress.companyName }}
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <h6 class="text-h6 text-no-wrap mb-2">
                      Email –¥–ª—è –æ–ø–ª–∞—Ç—ã:
                    </h6>
                  </td>
                  <td>
                    <p class="text-body-1 mb-2">
                      {{ currentAddress.billingEmail }}
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <h6 class="text-h6 text-no-wrap mb-2">
                      –ù–∞–ª–æ–≥–æ–≤—ã–π ID:
                    </h6>
                  </td>
                  <td>
                    <p class="text-body-1 mb-2">
                      {{ currentAddress.taxID }}
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <h6 class="text-h6 text-no-wrap mb-2">
                      –ù–î–° –Ω–æ–º–µ—Ä:
                    </h6>
                  </td>
                  <td>
                    <p class="text-body-1 mb-2">
                      {{ currentAddress.vatNumber }}
                    </p>
                  </td>
                </tr>
                <tr>
                  <td class="d-flex align-baseline">
                    <h6 class="text-h6 text-no-wrap">
                      –ê–¥—Ä–µ—Å –¥–ª—è –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–æ–≤:
                    </h6>
                  </td>
                  <td>
                    <p class="text-body-1 mb-2">
                      {{ currentAddress.address }}
                    </p>
                  </td>
                </tr>
              </VTable>
            </VCol>

            <VCol
              cols="12"
              lg="6"
            >
              <VTable class="billing-address-table">
                <tr>
                  <td>
                    <h6 class="text-h6 text-no-wrap mb-2">
                      –ö–æ–Ω—Ç–∞–∫—Ç:
                    </h6>
                  </td>
                  <td>
                    <p class="text-body-1 mb-2">
                      {{ currentAddress.contact }}
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <h6 class="text-h6 text-no-wrap mb-2">
                      –°—Ç—Ä–∞–Ω–∞:
                    </h6>
                  </td>
                  <td>
                    <p class="text-body-1 mb-2">
                      {{ currentAddress.country }}
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <h6 class="text-h6 text-no-wrap mb-2">
                      –†–µ–≥–∏–æ–Ω:
                    </h6>
                  </td>
                  <td>
                    <p class="text-body-1 mb-2">
                      {{ currentAddress.state }}
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <h6 class="text-h6 text-no-wrap mb-2">
                      –ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å:
                    </h6>
                  </td>
                  <td>
                    <p class="text-body-1 mb-2">
                      {{ currentAddress.zipCode }}
                    </p>
                  </td>
                </tr>
              </VTable>
            </VCol>
          </VRow>
        </VCardText>
      </VCard>
    </VCol>
  </VRow>

  <!-- üëâ Edit Card Dialog -->
  <CardAddEditDialog
    v-model:is-dialog-visible="isCardEditDialogVisible"
    :card-details="currentCardDetails"
  />

  <!-- üëâ Add Card Dialog -->
  <CardAddEditDialog v-model:is-dialog-visible="isCardAddDialogVisible" />

  <!-- üëâ Edit Address dialog -->
  <AddEditAddressDialog
    v-model:is-dialog-visible="isEditAddressDialogVisible"
    :billing-address="currentBillingAddress"
  />

  <!-- üëâ Upgrade plan dialog -->
  <UserUpgradePlanDialog v-model:is-dialog-visible="isUpgradePlanDialogVisible" />
</template>

<style lang="scss">
.billing-address-table {
  tr {
    td:first-child {
      inline-size: 148px;
    }
  }
}
</style>
